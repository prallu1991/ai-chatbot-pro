<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P.R.A.I â€“ Intelligent Assistant</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Reset and Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0f0f0f;
            color: #ffffff;
            line-height: 1.6;
            height: 100vh;
            overflow: hidden;
        }

        /* App Layout */
        .app {
            display: flex;
            height: 100vh;
            background: #0f0f0f;
        }

        /* ============================================
           SIDEBAR (Enhanced with more options)
           ============================================ */
        .sidebar {
            width: 280px;
            background: #161616;
            border-right: 1px solid #2a2a2a;
            display: flex;
            flex-direction: column;
            padding: 20px;
            transition: all 0.3s ease;
        }

        /* Logo - Enhanced with animation */
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #2a2a2a;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .logo:hover {
            transform: translateX(5px);
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            font-size: 20px;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .logo-text {
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* New Chat Button (Enhanced) */
        .new-chat-btn {
            width: 100%;
            padding: 14px 16px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
        }

        .new-chat-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(59, 130, 246, 0.3);
        }

        .new-chat-btn:active {
            transform: translateY(0);
        }

        /* History Section (Enhanced) */
        .history-section {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .history-title {
            font-size: 12px;
            color: #8a8a8a;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding-left: 4px;
        }

        .clear-all-btn {
            background: transparent;
            border: none;
            color: #8a8a8a;
            font-size: 11px;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .clear-all-btn:hover {
            background: #2a2a2a;
            color: #ff6b6b;
        }

        .history-list {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .history-item {
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            color: #d4d4d4;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
        }

        .history-item:hover {
            background: #2a2a2a;
            color: white;
            padding-right: 36px;
        }

        .history-item.active {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(29, 78, 216, 0.2));
            color: white;
            border-left: 3px solid #3b82f6;
        }

        .history-item-delete {
            position: absolute;
            right: 10px;
            background: transparent;
            border: none;
            color: #8a8a8a;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s;
            width: 24px;
            height: 24px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .history-item:hover .history-item-delete {
            opacity: 1;
        }

        .history-item-delete:hover {
            background: rgba(255, 107, 107, 0.1);
            color: #ff6b6b;
        }

        /* Model Selector (Enhanced) */
        .model-selector {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid #2a2a2a;
        }

        .model-label {
            font-size: 12px;
            color: #8a8a8a;
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
        }

        .model-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .model-badge {
            padding: 8px 14px;
            background: #2a2a2a;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            color: #8a8a8a;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid transparent;
        }

        .model-badge:hover {
            background: #3a3a3a;
            color: white;
            transform: translateY(-2px);
        }

        .model-badge.active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        /* ============================================
           MAIN CHAT AREA (Enhanced)
           ============================================ */
        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #0f0f0f;
            position: relative;
        }

        /* Chat Header (Enhanced) */
        .chat-header {
            padding: 18px 24px;
            border-bottom: 1px solid #2a2a2a;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #161616;
        }

        .chat-title-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .chat-title {
            font-size: 17px;
            font-weight: 600;
            color: white;
        }

        .chat-subtitle {
            font-size: 13px;
            color: #8a8a8a;
            font-weight: 500;
        }

        .header-actions {
            display: flex;
            gap: 8px;
        }

        .header-btn {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            border: 1px solid #2a2a2a;
            background: transparent;
            color: #8a8a8a;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .header-btn:hover {
            background: #2a2a2a;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .header-btn:active {
            transform: translateY(0);
        }

        .header-btn-tooltip {
            position: absolute;
            bottom: -30px;
            background: #2a2a2a;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: none;
            z-index: 10;
        }

        .header-btn:hover .header-btn-tooltip {
            opacity: 1;
        }

        /* Messages Container (Enhanced) */
        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            scroll-behavior: smooth;
        }

        /* Message (Enhanced with animations) */
        .message {
            max-width: 80%;
            animation: fadeInUp 0.4s ease;
            transform-origin: center;
        }

        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.95); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .user-message {
            align-self: flex-end;
        }

        .bot-message {
            align-self: flex-start;
        }

        .message-content {
            padding: 16px 20px;
            border-radius: 16px;
            font-size: 15px;
            line-height: 1.6;
            word-break: break-word;
            position: relative;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .user-message .message-content {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .bot-message .message-content {
            background: #2a2a2a;
            color: #f0f0f0;
            border-bottom-left-radius: 4px;
        }

        .message-sender {
            display: block;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 6px;
            color: #8a8a8a;
        }

        .message-time {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 8px;
            text-align: right;
        }

        .message-actions {
            display: flex;
            gap: 8px;
            margin-top: 8px;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .message:hover .message-actions {
            opacity: 1;
        }

        .message-action-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #8a8a8a;
            width: 28px;
            height: 28px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .message-action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        /* Typing Indicator (Enhanced) */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 16px 20px;
            background: #2a2a2a;
            border-radius: 16px;
            border-bottom-left-radius: 4px;
            width: fit-content;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .typing-text {
            font-size: 14px;
            color: #8a8a8a;
            margin-right: 8px;
        }

        .typing-dot {
            width: 10px;
            height: 10px;
            background: #3b82f6;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
            box-shadow: 0 0 8px rgba(59, 130, 246, 0.5);
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
            30% { transform: translateY(-10px); opacity: 1; }
        }

        /* Input Area (Enhanced with better alignment) */
        .input-area {
            padding: 20px 24px;
            border-top: 1px solid #2a2a2a;
            background: #161616;
        }

        .input-container {
            position: relative;
            margin-bottom: 12px;
            display: flex;
            align-items: flex-end;
        }

        .message-input {
            width: 100%;
            padding: 16px 60px 16px 16px;
            background: #2a2a2a;
            border: 1px solid transparent;
            border-radius: 12px;
            color: white;
            font-size: 15px;
            font-family: 'Inter', sans-serif;
            resize: none;
            min-height: 56px;
            max-height: 200px;
            line-height: 1.6;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .message-input:focus {
            outline: none;
            border-color: #3b82f6;
            background: #333333;
            box-shadow: 0 6px 16px rgba(59, 130, 246, 0.2);
        }

        .message-input::placeholder {
            color: #8a8a8a;
        }

        .input-buttons {
            position: absolute;
            right: 8px;
            bottom: 8px;
            display: flex;
            gap: 8px;
        }

        .send-button {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .send-button:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
            animation: pulse 1s infinite;
        }

        .send-button:active {
            transform: translateY(0);
        }

        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            animation: none !important;
        }

        .attach-button {
            width: 44px;
            height: 44px;
            background: #3a3a3a;
            border: none;
            border-radius: 10px;
            color: #8a8a8a;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .attach-button:hover {
            background: #4a4a4a;
            color: white;
            transform: translateY(-2px);
        }

        /* Quick Actions (Enhanced) */
        .quick-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .quick-action {
            padding: 10px 16px;
            background: #2a2a2a;
            border: none;
            border-radius: 10px;
            color: #8a8a8a;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quick-action:hover {
            background: #3a3a3a;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .quick-action:active {
            transform: translateY(0);
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: #1e1e1e;
            border-radius: 16px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            transform: translateY(20px);
            transition: transform 0.3s;
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 10px;
            color: white;
        }

        .modal-text {
            color: #8a8a8a;
            margin-bottom: 24px;
            line-height: 1.6;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .modal-btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-btn-cancel {
            background: #2a2a2a;
            color: #8a8a8a;
        }

        .modal-btn-cancel:hover {
            background: #3a3a3a;
            color: white;
        }

        .modal-btn-confirm {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }

        .modal-btn-confirm:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        /* Scroll to bottom button */
        .scroll-to-bottom {
            position: absolute;
            bottom: 100px;
            right: 30px;
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s;
            z-index: 100;
        }

        .scroll-to-bottom.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .scroll-to-bottom:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
        }

        /* File Preview */
        .file-preview {
            background: #2a2a2a;
            border-radius: 12px;
            padding: 12px 16px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            animation: fadeInUp 0.3s ease;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .file-details h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .file-details p {
            font-size: 12px;
            color: #8a8a8a;
        }

        .file-remove {
            background: transparent;
            border: none;
            color: #8a8a8a;
            cursor: pointer;
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .file-remove:hover {
            background: rgba(255, 107, 107, 0.1);
            color: #ff6b6b;
        }

        /* Scrollbar Styling (Enhanced) */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #4a4a4a;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #5a5a5a;
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .fade-in {
            animation: fadeInUp 0.4s ease;
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        /* ============================================
           RESPONSIVE DESIGN (Enhanced)
           ============================================ */
        @media (max-width: 768px) {
            .app {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                max-height: 60vh;
                border-right: none;
                border-bottom: 1px solid #2a2a2a;
            }
            
            .message {
                max-width: 90%;
            }
            
            .messages-container {
                padding: 16px;
                gap: 16px;
            }
            
            .input-area {
                padding: 16px;
            }
            
            .scroll-to-bottom {
                bottom: 90px;
                right: 20px;
            }
            
            .modal-content {
                width: 95%;
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .logo-text {
                font-size: 18px;
            }
            
            .message-content {
                padding: 14px 16px;
                font-size: 14px;
            }
            
            .message-input {
                padding: 14px 56px 14px 14px;
                min-height: 52px;
            }
            
            .send-button, .attach-button {
                width: 40px;
                height: 40px;
            }
            
            .quick-action {
                padding: 8px 12px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- Main App -->
    <div class="app">
        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Logo -->
            <div class="logo" id="logo">
                <div class="logo-icon">P</div>
                <div class="logo-text">P.R.A.I</div>
            </div>

            <!-- New Chat Button -->
            <button class="new-chat-btn" id="new-chat-btn">
                <i class="fas fa-plus"></i>
                <span>New Chat</span>
            </button>

            <!-- History -->
            <div class="history-section">
                <div class="history-header">
                    <div class="history-title">Recent Conversations</div>
                    <button class="clear-all-btn" id="clear-all-btn">
                        <i class="fas fa-trash"></i>
                        Clear All
                    </button>
                </div>
                <div class="history-list" id="history-list">
                    <div class="history-item" id="empty-history">
                        <span>No conversations yet</span>
                    </div>
                </div>
            </div>

            <!-- Model Selector -->
            <div class="model-selector">
                <span class="model-label">AI Model</span>
                <div class="model-badges">
                    <span class="model-badge active" data-model="llama">Llama 3.3</span>
                    <span class="model-badge" data-model="gpt">GPT-4</span>
                    <span class="model-badge" data-model="claude">Claude 3</span>
                    <span class="model-badge" data-model="gemini">Gemini Pro</span>
                </div>
            </div>
        </aside>

        <!-- Main Chat Area -->
        <main class="chat-area">
            <!-- Header -->
            <div class="chat-header">
                <div class="chat-title-container">
                    <div class="chat-title">P.R.A.I Assistant</div>
                    <div class="chat-subtitle" id="chat-subtitle">Ready to assist</div>
                </div>
                <div class="header-actions">
                    <button class="header-btn" id="theme-btn" title="Toggle Theme">
                        <i class="fas fa-moon"></i>
                        <span class="header-btn-tooltip">Toggle Theme</span>
                    </button>
                    <button class="header-btn" id="clear-btn" title="Clear Chat">
                        <i class="fas fa-trash"></i>
                        <span class="header-btn-tooltip">Clear Chat</span>
                    </button>
                    <button class="header-btn" id="export-btn" title="Export Chat">
                        <i class="fas fa-download"></i>
                        <span class="header-btn-tooltip">Export Chat</span>
                    </button>
                </div>
            </div>

            <!-- Messages -->
            <div class="messages-container" id="messages-container">
                <!-- Messages will be inserted here -->
            </div>

            <!-- Scroll to bottom button -->
            <button class="scroll-to-bottom" id="scroll-to-bottom">
                <i class="fas fa-arrow-down"></i>
            </button>

            <!-- Input Area -->
            <div class="input-area">
                <!-- File Preview -->
                <div class="file-preview hidden" id="file-preview">
                    <div class="file-info">
                        <div class="file-icon">
                            <i class="fas fa-file"></i>
                        </div>
                        <div class="file-details">
                            <h4 id="file-name">No file selected</h4>
                            <p id="file-size">Upload a file to analyze</p>
                        </div>
                    </div>
                    <button class="file-remove" id="file-remove">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div class="input-container">
                    <textarea 
                        class="message-input" 
                        id="message-input"
                        placeholder="Message P.R.A.I... (Press Enter to send, Shift+Enter for new line)"
                        rows="1"
                    ></textarea>
                    <div class="input-buttons">
                        <button class="attach-button" id="attach-button" title="Attach file">
                            <i class="fas fa-paperclip"></i>
                        </button>
                        <button class="send-button" id="send-button" title="Send message">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
                <div class="quick-actions">
                    <button class="quick-action" id="suggest-btn">
                        <i class="fas fa-lightbulb"></i>
                        Get suggestions
                    </button>
                    <button class="quick-action" id="voice-btn">
                        <i class="fas fa-microphone"></i>
                        Voice input
                    </button>
                    <button class="quick-action" id="format-btn">
                        <i class="fas fa-code"></i>
                        Format code
                    </button>
                    <input type="file" id="file-input" class="hidden" accept=".txt,.pdf,.doc,.docx,.jpg,.png">
                </div>
            </div>
        </main>
    </div>

    <!-- Modal for confirmation -->
    <div class="modal" id="confirm-modal">
        <div class="modal-content">
            <h3 class="modal-title" id="modal-title">Confirm Action</h3>
            <p class="modal-text" id="modal-text">Are you sure you want to proceed?</p>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-cancel" id="modal-cancel">Cancel</button>
                <button class="modal-btn modal-btn-confirm" id="modal-confirm">Confirm</button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // STATE MANAGEMENT
        // ============================================
        let currentChatId = 'chat-' + Date.now();
        let chats = {};
        let uploadedFile = null;
        let currentModel = 'llama';
        let isDarkTheme = true;
        let autoScrollEnabled = true;
        let pendingAction = null;

        // ============================================
        // DOM ELEMENTS
        // ============================================
        const messagesContainer = document.getElementById('messages-container');
        const messageInput = document.getElementById('message-input');
        const sendButton = document.getElementById('send-button');
        const newChatBtn = document.getElementById('new-chat-btn');
        const historyList = document.getElementById('history-list');
        const emptyHistory = document.getElementById('empty-history');
        const clearBtn = document.getElementById('clear-btn');
        const clearAllBtn = document.getElementById('clear-all-btn');
        const exportBtn = document.getElementById('export-btn');
        const themeBtn = document.getElementById('theme-btn');
        const suggestBtn = document.getElementById('suggest-btn');
        const voiceBtn = document.getElementById('voice-btn');
        const formatBtn = document.getElementById('format-btn');
        const attachBtn = document.getElementById('attach-button');
        const fileInput = document.getElementById('file-input');
        const filePreview = document.getElementById('file-preview');
        const fileName = document.getElementById('file-name');
        const fileSize = document.getElementById('file-size');
        const fileRemove = document.getElementById('file-remove');
        const scrollToBottomBtn = document.getElementById('scroll-to-bottom');
        const confirmModal = document.getElementById('confirm-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalText = document.getElementById('modal-text');
        const modalCancel = document.getElementById('modal-cancel');
        const modalConfirm = document.getElementById('modal-confirm');
        const chatSubtitle = document.getElementById('chat-subtitle');
        const modelBadges = document.querySelectorAll('.model-badge');
        const logo = document.getElementById('logo');

        // ============================================
        // INITIALIZATION
        // ============================================
        function init() {
            loadFromStorage();
            updateHistoryDisplay();
            addWelcomeMessage();
            messageInput.focus();
            setupEventListeners();
            checkScrollButton();
            
            // Set initial theme
            updateTheme();
            
            // Set initial model
            setActiveModel(currentModel);
            
            // Add logo animation
            setTimeout(() => {
                logo.classList.add('pulse-animation');
                setTimeout(() => {
                    logo.classList.remove('pulse-animation');
                }, 2000);
            }, 1000);
        }

        function loadFromStorage() {
            const savedChats = localStorage.getItem('praiChats');
            if (savedChats) {
                chats = JSON.parse(savedChats);
            }
            
            const savedTheme = localStorage.getItem('praiTheme');
            if (savedTheme) {
                isDarkTheme = savedTheme === 'dark';
            }
            
            const savedModel = localStorage.getItem('praiModel');
            if (savedModel) {
                currentModel = savedModel;
            }
        }

        function saveToStorage() {
            localStorage.setItem('praiChats', JSON.stringify(chats));
            localStorage.setItem('praiTheme', isDarkTheme ? 'dark' : 'light');
            localStorage.setItem('praiModel', currentModel);
        }

        // ============================================
        // MESSAGE FUNCTIONS
        // ============================================
        function addMessage(content, isUser, timestamp = null) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'} fade-in`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            const senderSpan = document.createElement('span');
            senderSpan.className = 'message-sender';
            senderSpan.textContent = isUser ? 'You' : 'P.R.A.I';
            contentDiv.appendChild(senderSpan);
            
            const textDiv = document.createElement('div');
            textDiv.textContent = content;
            contentDiv.appendChild(textDiv);
            
            const timeSpan = document.createElement('div');
            timeSpan.className = 'message-time';
            timeSpan.textContent = timestamp || new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            contentDiv.appendChild(timeSpan);
            
            // Add message actions (copy, edit, etc.)
            if (!isUser) {
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'message-actions';
                
                const copyBtn = document.createElement('button');
                copyBtn.className = 'message-action-btn';
                copyBtn.innerHTML = '<i class="fas fa-copy"></i>';
                copyBtn.title = 'Copy message';
                copyBtn.onclick = () => {
                    navigator.clipboard.writeText(content);
                    copyBtn.innerHTML = '<i class="fas fa-check"></i>';
                    copyBtn.style.color = '#4ade80';
                    setTimeout(() => {
                        copyBtn.innerHTML = '<i class="fas fa-copy"></i>';
                        copyBtn.style.color = '';
                    }, 2000);
                };
                actionsDiv.appendChild(copyBtn);
                
                contentDiv.appendChild(actionsDiv);
            }
            
            messageDiv.appendChild(contentDiv);
            messagesContainer.appendChild(messageDiv);
            
            // Auto-scroll to bottom if enabled
            if (autoScrollEnabled) {
                scrollToBottom();
            }
            
            checkScrollButton();
            
            // Save to chat history
            if (!chats[currentChatId]) {
                chats[currentChatId] = {
                    id: currentChatId,
                    title: content.substring(0, 50) + (content.length > 50 ? '...' : ''),
                    messages: [],
                    timestamp: Date.now(),
                    model: currentModel
                };
            }
            
            chats[currentChatId].messages.push({
                content,
                isUser,
                timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
            });
            
            chats[currentChatId].title = chats[currentChatId].messages[0]?.content.substring(0, 50) + 
                                        (chats[currentChatId].messages[0]?.content.length > 50 ? '...' : '') || 'New Chat';
            chats[currentChatId].timestamp = Date.now();
            
            saveToStorage();
            updateHistoryDisplay();
            updateChatSubtitle();
        }

        function addWelcomeMessage() {
            const welcomeMessages = [
                "Hello! I'm P.R.A.I, your intelligent assistant. I can help with questions, analysis, coding, and more. How can I assist you today?",
                "Welcome to P.R.A.I. I'm here to help with any tasks or questions you might have. What would you like to explore?",
                "Hi there! I'm P.R.A.I, ready to assist. I can analyze documents, answer questions, write code, and more. What's on your mind?"
            ];
            
            const modelNames = {
                'llama': 'Llama 3.3',
                'gpt': 'GPT-4',
                'claude': 'Claude 3',
                'gemini': 'Gemini Pro'
            };
            
            const modelName = modelNames[currentModel] || 'Llama 3.3';
            const welcomeMessage = welcomeMessages[Math.floor(Math.random() * welcomeMessages.length)];
            const fullMessage = `${welcomeMessage}\n\nCurrently using ${modelName} model.`;
            
            addMessage(fullMessage, false);
        }

        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typing-indicator';
            
            const typingText = document.createElement('div');
            typingText.className = 'typing-text';
            typingText.textContent = 'P.R.A.I is typing';
            typingDiv.appendChild(typingText);
            
            for (let i = 0; i < 3; i++) {
                const dot = document.createElement('div');
                dot.className = 'typing-dot';
                typingDiv.appendChild(dot);
            }
            
            messagesContainer.appendChild(typingDiv);
            scrollToBottom();
        }

        function hideTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) {
                indicator.style.opacity = '0';
                indicator.style.transform = 'translateY(10px)';
                setTimeout(() => {
                    if (indicator.parentNode) {
                        indicator.parentNode.removeChild(indicator);
                    }
                }, 300);
            }
        }

        async function sendMessage() {
            const content = messageInput.value.trim();
            if (!content) return;
            
            addMessage(content, true);
            messageInput.value = '';
            messageInput.style.height = 'auto';
            sendButton.disabled = true;
            showTypingIndicator();
            
            try {
                // Simulate API call with different responses based on content
                setTimeout(() => {
                    hideTypingIndicator();
                    
                    // Generate different responses based on content
                    let response = generateResponse(content);
                    
                    // If there's an uploaded file, mention it in the response
                    if (uploadedFile) {
                        response = `Based on the file "${uploadedFile.name}" (${formatFileSize(uploadedFile.size)}), ${response}`;
                    }
                    
                    addMessage(response, false);
                    
                    // Reset file after sending
                    if (uploadedFile) {
                        uploadedFile = null;
                        filePreview.classList.add('hidden');
                    }
                    
                    sendButton.disabled = false;
                    messageInput.focus();
                }, 1500 + Math.random() * 1000); // Random delay between 1.5-2.5 seconds
            } catch (error) {
                hideTypingIndicator();
                addMessage('Sorry, I encountered an error. Please try again.', false);
                sendButton.disabled = false;
                messageInput.focus();
            }
        }

        function generateResponse(query) {
            const responses = {
                greeting: [
                    "Hello! How can I assist you today?",
                    "Hi there! What can I help you with?",
                    "Greetings! I'm here to help. What do you need assistance with?"
                ],
                question: [
                    "That's an interesting question. Let me think about this... Based on my knowledge, ",
                    "I understand you're asking about this topic. Here's what I know: ",
                    "Great question! Here's my analysis: "
                ],
                code: [
                    "I can help with that! Here's a solution: ",
                    "For that coding task, I recommend: ",
                    "Here's an approach you could take: "
                ],
                file: [
                    "I've analyzed the content you provided. ",
                    "Based on the document you uploaded, here are my insights: ",
                    "After reviewing the file, I can tell you that "
                ],
                default: [
                    "I understand. Let me provide some helpful information about that.",
                    "Thanks for sharing that with me. Here's what I think:",
                    "Interesting! Here are my thoughts on that topic:"
                ]
            };
            
            // Determine response type
            let type = 'default';
            const lowerQuery = query.toLowerCase();
            
            if (lowerQuery.includes('hello') || lowerQuery.includes('hi') || lowerQuery.includes('hey')) {
                type = 'greeting';
            } else if (lowerQuery.includes('?') || lowerQuery.includes('how') || lowerQuery.includes('what') || lowerQuery.includes('why')) {
                type = 'question';
            } else if (lowerQuery.includes('code') || lowerQuery.includes('program') || lowerQuery.includes('function') || lowerQuery.includes('script')) {
                type = 'code';
            } else if (lowerQuery.includes('file') || lowerQuery.includes('document') || lowerQuery.includes('upload')) {
                type = 'file';
            }
            
            const responseArray = responses[type];
            const randomResponse = responseArray[Math.floor(Math.random() * responseArray.length)];
            
            // Add some specific content based on query
            if (type === 'code' && lowerQuery.includes('python')) {
                return randomResponse + "\n```python\ndef example_function():\n    print('Hello, World!')\n    return True\n```\nThis is a simple Python function that prints a message and returns True.";
            } else if (type === 'code' && lowerQuery.includes('javascript')) {
                return randomResponse + "\n```javascript\nfunction exampleFunction() {\n    console.log('Hello, World!');\n    return true;\n}\n```\nThis JavaScript function logs a message to the console and returns true.";
            } else if (type === 'question' && (lowerQuery.includes('ai') || lowerQuery.includes('artificial intelligence'))) {
                return randomResponse + "Artificial Intelligence refers to systems that perform tasks that typically require human intelligence, such as visual perception, speech recognition, and decision-making. Modern AI uses machine learning and deep learning techniques.";
            }
            
            return randomResponse + " I'm using the " + currentModel.toUpperCase() + " model to provide you with the most accurate information possible.";
        }

        // ============================================
        // HISTORY MANAGEMENT
        // ============================================
        function updateHistoryDisplay() {
            historyList.innerHTML = '';
            
            if (Object.keys(chats).length === 0) {
                emptyHistory.classList.remove('hidden');
                historyList.appendChild(emptyHistory);
                return;
            }
            
            emptyHistory.classList.add('hidden');
            
            // Sort chats by timestamp (newest first)
            const sortedChats = Object.values(chats).sort((a, b) => b.timestamp - a.timestamp);
            
            sortedChats.forEach(chat => {
                const item = document.createElement('div');
                item.className = `history-item ${chat.id === currentChatId ? 'active' : ''}`;
                
                const titleSpan = document.createElement('span');
                titleSpan.textContent = chat.title;
                item.appendChild(titleSpan);
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'history-item-delete';
                deleteBtn.innerHTML = '<i class="fas fa-times"></i>';
                deleteBtn.onclick = (e) => {
                    e.stopPropagation();
                    showConfirmModal(
                        'Delete Conversation',
                        `Are you sure you want to delete "${chat.title}"?`,
                        () => deleteChat(chat.id)
                    );
                };
                item.appendChild(deleteBtn);
                
                item.onclick = () => loadChat(chat.id);
                historyList.appendChild(item);
            });
        }

        function loadChat(chatId) {
            currentChatId = chatId;
            messagesContainer.innerHTML = '';
            
            const chat = chats[chatId];
            if (chat && chat.messages.length > 0) {
                chat.messages.forEach(msg => {
                    addMessage(msg.content, msg.isUser, msg.timestamp);
                });
                
                // Set the model if it exists in chat data
                if (chat.model) {
                    setActiveModel(chat.model);
                }
            } else {
                addWelcomeMessage();
            }
            
            updateHistoryDisplay();
            updateChatSubtitle();
        }

        function deleteChat(chatId) {
            delete chats[chatId];
            saveToStorage();
            updateHistoryDisplay();
            
            // If we deleted the current chat, create a new one
            if (chatId === currentChatId) {
                newChat();
            }
        }

        function clearAllChats() {
            chats = {};
            saveToStorage();
            updateHistoryDisplay();
            newChat();
        }

        function newChat() {
            currentChatId = 'chat-' + Date.now();
            messagesContainer.innerHTML = '';
            addWelcomeMessage();
            updateChatSubtitle();
            
            // Remove file preview if any
            uploadedFile = null;
            filePreview.classList.add('hidden');
        }

        // ============================================
        // UI ENHANCEMENTS
        // ============================================
        function updateTheme() {
            if (isDarkTheme) {
                document.body.style.backgroundColor = '#0f0f0f';
                document.body.style.color = '#ffffff';
                themeBtn.innerHTML = '<i class="fas fa-sun"></i><span class="header-btn-tooltip">Light Mode</span>';
            } else {
                document.body.style.backgroundColor = '#f5f5f5';
                document.body.style.color = '#333333';
                themeBtn.innerHTML = '<i class="fas fa-moon"></i><span class="header-btn-tooltip">Dark Mode</span>';
            }
            
            // Update theme icon tooltip
            const tooltip = themeBtn.querySelector('.header-btn-tooltip');
            tooltip.textContent = isDarkTheme ? 'Light Mode' : 'Dark Mode';
        }

        function toggleTheme() {
            isDarkTheme = !isDarkTheme;
            updateTheme();
            saveToStorage();
        }

        function setActiveModel(model) {
            currentModel = model;
            
            // Update UI
            modelBadges.forEach(badge => {
                if (badge.dataset.model === model) {
                    badge.classList.add('active');
                } else {
                    badge.classList.remove('active');
                }
            });
            
            // Update current chat model
            if (chats[currentChatId]) {
                chats[currentChatId].model = model;
                saveToStorage();
            }
            
            // Update subtitle
            updateChatSubtitle();
        }

        function updateChatSubtitle() {
            const modelNames = {
                'llama': 'Llama 3.3',
                'gpt': 'GPT-4',
                'claude': 'Claude 3',
                'gemini': 'Gemini Pro'
            };
            
            const modelName = modelNames[currentModel] || 'Llama 3.3';
            const messageCount = chats[currentChatId]?.messages?.length || 0;
            
            if (messageCount > 1) {
                chatSubtitle.textContent = `${messageCount - 1} messages â€¢ ${modelName}`;
            } else {
                chatSubtitle.textContent = `New conversation â€¢ ${modelName}`;
            }
        }

        function scrollToBottom() {
            messagesContainer.scrollTo({
                top: messagesContainer.scrollHeight,
                behavior: 'smooth'
            });
        }

        function checkScrollButton() {
            const isAtBottom = messagesContainer.scrollHeight - messagesContainer.clientHeight <= messagesContainer.scrollTop + 100;
            
            if (isAtBottom) {
                scrollToBottomBtn.classList.remove('visible');
            } else {
                scrollToBottomBtn.classList.add('visible');
            }
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // ============================================
        // MODAL FUNCTIONS
        // ============================================
        function showConfirmModal(title, text, confirmCallback) {
            modalTitle.textContent = title;
            modalText.textContent = text;
            pendingAction = confirmCallback;
            confirmModal.classList.add('active');
        }

        function hideConfirmModal() {
            confirmModal.classList.remove('active');
            pendingAction = null;
        }

        // ============================================
        // EVENT LISTENERS
        // ============================================
        function setupEventListeners() {
            // Input handling
            messageInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 200) + 'px';
            });

            messageInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // Button events
            sendButton.addEventListener('click', sendMessage);
            
            newChatBtn.addEventListener('click', () => {
                newChat();
            });

            clearBtn.addEventListener('click', () => {
                showConfirmModal(
                    'Clear Conversation',
                    'Are you sure you want to clear this conversation? This action cannot be undone.',
                    () => {
                        messagesContainer.innerHTML = '';
                        if (chats[currentChatId]) {
                            chats[currentChatId].messages = [];
                        }
                        addWelcomeMessage();
                        saveToStorage();
                    }
                );
            });

            clearAllBtn.addEventListener('click', () => {
                showConfirmModal(
                    'Clear All Conversations',
                    'Are you sure you want to delete all conversations? This action cannot be undone.',
                    clearAllChats
                );
            });

            exportBtn.addEventListener('click', () => {
                const currentChat = chats[currentChatId];
                if (!currentChat || currentChat.messages.length === 0) {
                    showConfirmModal(
                        'Export Error',
                        'No messages to export.',
                        null
                    );
                    return;
                }
                
                let exportText = `P.R.A.I Chat Export\nGenerated: ${new Date().toLocaleString()}\nModel: ${currentChat.model || 'Llama 3.3'}\n\n`;
                currentChat.messages.forEach(msg => {
                    exportText += `${msg.timestamp} - ${msg.isUser ? 'You' : 'P.R.A.I'}:\n${msg.content}\n\n`;
                });
                
                const blob = new Blob([exportText], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `prai-chat-${currentChatId.slice(-8)}.txt`;
                a.click();
                URL.revokeObjectURL(url);
            });

            themeBtn.addEventListener('click', toggleTheme);

            // Model selection
            modelBadges.forEach(badge => {
                badge.addEventListener('click', () => {
                    setActiveModel(badge.dataset.model);
                    saveToStorage();
                });
            });

            // Suggestions
            const suggestions = [
                "Explain quantum computing in simple terms",
                "Write a Python script for data analysis",
                "Help me design a project timeline",
                "Analyze this business strategy",
                "Create a creative story concept",
                "How can I improve my productivity?",
                "Explain the theory of relativity"
            ];

            suggestBtn.addEventListener('click', () => {
                const randomSuggestion = suggestions[Math.floor(Math.random() * suggestions.length)];
                messageInput.value = randomSuggestion;
                messageInput.focus();
                messageInput.style.height = 'auto';
                messageInput.style.height = Math.min(messageInput.scrollHeight, 200) + 'px';
            });

            // Voice input (simulated)
            voiceBtn.addEventListener('click', () => {
                if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
                    addMessage("Voice input is not supported in your browser. Try Chrome or Edge.", false);
                    return;
                }
                
                // Simulate voice input for demo
                messageInput.value = "This is a simulated voice input. In a real implementation, this would use the Web Speech API.";
                messageInput.focus();
                messageInput.style.height = 'auto';
                messageInput.style.height = Math.min(messageInput.scrollHeight, 200) + 'px';
            });

            // Format code button
            formatBtn.addEventListener('click', () => {
                const codeExamples = [
                    "```python\ndef calculate_fibonacci(n):\n    if n <= 1:\n        return n\n    else:\n        return calculate_fibonacci(n-1) + calculate_fibonacci(n-2)\n```",
                    "```javascript\nfunction filterArray(arr, condition) {\n    return arr.filter(item => condition(item));\n}\n\nconst numbers = [1, 2, 3, 4, 5];\nconst evenNumbers = filterArray(numbers, n => n % 2 === 0);\n```",
                    "```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Example Page</title>\n    <style>\n        body { font-family: Arial; margin: 0; padding: 20px; }\n        .container { max-width: 800px; margin: 0 auto; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>Hello World</h1>\n    </div>\n</body>\n</html>```"
                ];
                
                const randomExample = codeExamples[Math.floor(Math.random() * codeExamples.length)];
                messageInput.value = "Can you format this code properly?\n\n" + randomExample;
                messageInput.focus();
                messageInput.style.height = 'auto';
                messageInput.style.height = Math.min(messageInput.scrollHeight, 200) + 'px';
            });

            // File attachment
            attachBtn.addEventListener('click', () => {
                fileInput.click();
            });

            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                uploadedFile = file;
                
                // Show file preview
                fileName.textContent = file.name;
                fileSize.textContent = formatFileSize(file.size);
                filePreview.classList.remove('hidden');
                
                // Add a message about the file
                addMessage(`ðŸ“Ž Attached file: "${file.name}" (${formatFileSize(file.size)})`, true);
                
                // Reset file input
                fileInput.value = '';
            });

            fileRemove.addEventListener('click', () => {
                uploadedFile = null;
                filePreview.classList.add('hidden');
                addMessage("File attachment removed", true);
            });

            // Scroll to bottom button
            scrollToBottomBtn.addEventListener('click', scrollToBottom);

            // Messages container scroll event
            messagesContainer.addEventListener('scroll', checkScrollButton);

            // Modal events
            modalCancel.addEventListener('click', hideConfirmModal);
            
            modalConfirm.addEventListener('click', () => {
                if (pendingAction) {
                    pendingAction();
                }
                hideConfirmModal();
            });

            // Close modal when clicking outside
            confirmModal.addEventListener('click', (e) => {
                if (e.target === confirmModal) {
                    hideConfirmModal();
                }
            });

            // Auto-focus input on click
            document.addEventListener('click', (e) => {
                // Don't refocus if clicking on input or buttons
                if (!e.target.matches('.message-input, .send-button, .attach-button, .header-btn, .history-item, .history-item *, .modal, .modal *')) {
                    if (messageInput !== document.activeElement) {
                        messageInput.focus();
                    }
                }
            });

            // Logo click animation
            logo.addEventListener('click', () => {
                logo.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    logo.style.transform = '';
                }, 200);
                
                // Add a fun message
                addMessage("ðŸ‘‹ Hello! I'm P.R.A.I, your personal AI assistant. Click the model badges to switch between different AI models!", false);
            });
        }

        // ============================================
        // INITIALIZE APP
        // ============================================
        init();
    </script>
</body>
</html>
